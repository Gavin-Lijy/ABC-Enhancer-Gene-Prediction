JOB_ID=618444
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=22684, mem_mib=21634, disk_mb=1418, disk_mib=1353
Conda environments: ignored
Select jobs to execute...

[Tue Mar  4 15:19:32 2025]
rule make_candidate_regions:
    input: /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted, /home/jl9324/Sperm_3D_Genome_Project/multiome/processed/bigwig/Spermatocytes.tagAlign.gz, /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/tmp/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed
    output: /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.candidateRegions.bed
    jobid: 0
    reason: Forced execution
    wildcards: biosample=SPT
    resources: mem_mb=22684, mem_mib=21634, disk_mb=1418, disk_mib=1353, tmpdir=/home/jl9324/mnt/scratch/jl9324


		python /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/workflow/scripts/makeCandidateRegions.py 			--narrowPeak /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted			--accessibility /home/jl9324/Sperm_3D_Genome_Project/multiome/processed/bigwig/Spermatocytes.tagAlign.gz 			--outDir /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks 			--chrom_sizes /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv 			--chrom_sizes_bed /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/tmp/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed 			--regions_blocklist /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_unified_blacklist.bed 			--regions_includelist /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/CollapsedGeneBounds.hg38.TSS500bp.bed 			--peakExtendFromSummit 250 			--nStrongestPeak 150000
		
***** WARNING: File /home/jl9324/Sperm_3D_Genome_Project/multiome/processed/bigwig/Spermatocytes.tagAlign.gz has inconsistent naming convention for record:
GL000009.2	3332	3356	N	1000	+

***** WARNING: File /home/jl9324/Sperm_3D_Genome_Project/multiome/processed/bigwig/Spermatocytes.tagAlign.gz has inconsistent naming convention for record:
GL000009.2	3332	3356	N	1000	+

Running piped cmds: ['bedtools intersect -u -a /home/jl9324/Sperm_3D_Genome_Project/multiome/processed/bigwig/Spermatocytes.tagAlign.gz -b /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/tmp/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed', 'bedtools coverage -counts -sorted -g /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv -b - -a /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted', 'awk \'{{print $1 "\\t" $2 "\\t" $3 "\\t" $NF}}\' > /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed']
Running command: awk 'BEGIN {FS=OFS="\t"} (substr($1, length($1)) == "X" || substr($1, length($1)) == "Y") { $4 *= 2 } 1' /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed > /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed.tmp && mv /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed.tmp /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed
Running piped cmds: ['bedtools sort -i /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.Spermatocytes.tagAlign.gz.Counts.bed -faidx /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin -c 4 -o max', 'sort -nr -k 4', 'head -n 150000', 'bedtools intersect -b stdin -a /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted -wa', 'awk \'{{print $1 "\\t" $2 + $10 "\\t" $2 + $10}}\'', 'bedtools slop -i stdin -b 250 -g /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools sort -i stdin -faidx /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin', 'bedtools intersect -v -wa -a stdin -b /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_unified_blacklist.bed', 'cut -f 1-3', '(bedtools intersect -a /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/CollapsedGeneBounds.hg38.TSS500bp.bed -b /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/tmp/GRCh38_EBV.no_alt.chrom.sizes.tsv.bed -wa | cut -f 1-3 && cat)', 'bedtools sort -i stdin -faidx /home/jl9324/env/download/ABC-Enhancer-Gene-Prediction/reference/hg38/GRCh38_EBV.no_alt.chrom.sizes.tsv', 'bedtools merge -i stdin > /home/jl9324/Sperm_3D_Genome_Project/multiome/ABC_model/SPT/Peaks/macs2_peaks.narrowPeak.sorted.candidateRegions.bed']
[Tue Mar  4 15:22:29 2025]
Finished job 0.
1 of 1 steps (100%) done
